<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ImageFlow | All-in-One File Toolkit</title>
    
    <!-- Power Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

    <style>
        :root {
            --primary: #6366f1;
            --primary-hover: #4f46e5;
            --secondary: #0f172a;
            --text-main: #334155;
            --text-light: #64748b;
            --bg: #ffffff;
            --card-bg: #f8fafc;
            --border: #e2e8f0;
            --radius-lg: 24px;
            --radius-md: 12px;
            --shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', -apple-system, sans-serif; }
        body { background-color: var(--bg); color: var(--text-main); line-height: 1.6; -webkit-font-smoothing: antialiased; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 24px; }

        /* Header */
        header { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(12px); border-bottom: 1px solid var(--border); padding: 16px 0; position: sticky; top: 0; z-index: 1000; }
        nav { display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 26px; font-weight: 800; color: var(--secondary); text-decoration: none; display: flex; align-items: center; gap: 10px; letter-spacing: -1px; }
        .logo-icon { background: var(--primary); width: 32px; height: 32px; border-radius: 8px; display: flex; align-items: center; justify-content: center; }
        .logo span { color: var(--primary); }

        /* Hero Section */
        .hero { padding: 80px 0 40px; text-align: center; }
        .hero h1 { font-size: 52px; font-weight: 900; color: var(--secondary); letter-spacing: -2px; line-height: 1.1; margin-bottom: 20px; }
        .hero h1 span { background: linear-gradient(90deg, var(--primary), #a855f7); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .hero p { font-size: 19px; color: var(--text-light); max-width: 680px; margin: 0 auto; }

        /* Tool Grid */
        .tool-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 24px; padding-bottom: 80px; }
        .tool-card {
            background: var(--card-bg);
            border: 1px solid var(--border);
            padding: 40px 30px;
            border-radius: var(--radius-lg);
            text-decoration: none;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
        .tool-card:hover { transform: translateY(-10px); background: white; border-color: var(--primary); box-shadow: var(--shadow); }
        .tool-card svg { width: 50px; height: 50px; margin-bottom: 20px; transition: 0.3s; }
        .tool-card:hover svg { transform: scale(1.1); }
        .tool-card h3 { color: var(--secondary); margin-bottom: 10px; font-size: 19px; font-weight: 700; }
        .tool-card p { font-size: 14px; color: var(--text-light); }

        /* Tool View */
        #tool-interface { display: none; padding: 60px 0; animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

        .back-link { cursor: pointer; color: var(--text-light); display: inline-flex; align-items: center; gap: 8px; font-weight: 600; margin-bottom: 30px; }
        .back-link:hover { color: var(--primary); }

        .workspace { background: white; border: 3px dashed var(--border); border-radius: 32px; padding: 100px 40px; text-align: center; transition: 0.3s; cursor: pointer; }
        .workspace:hover, .workspace.drag-over { border-color: var(--primary); background: #f5f3ff; }

        .btn { background: var(--primary); color: white; border: none; padding: 18px 45px; border-radius: 16px; font-size: 16px; font-weight: 700; cursor: pointer; transition: 0.3s; display: inline-block; text-decoration: none; }
        .btn:hover { background: var(--primary-hover); transform: translateY(-2px); }
        .btn-success { background: #10b981; }

        #file-input { display: none; }

        /* Progress Bar */
        #processing-ui { display: none; text-align: center; max-width: 500px; margin: 0 auto; }
        .progress-container { width: 100%; height: 10px; background: var(--border); border-radius: 20px; margin: 30px 0; overflow: hidden; }
        .progress-bar { width: 0%; height: 100%; background: var(--primary); transition: width 0.3s linear; }
        
        /* Success UI */
        #success-ui { display: none; text-align: center; }
        .success-icon { width: 70px; height: 70px; background: #d1fae5; color: #059669; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; font-size: 32px; font-weight: bold; }

        /* Footer */
        footer { border-top: 1px solid var(--border); padding: 60px 0; margin-top: 80px; text-align: center; background: #fcfcfd; }
        .footer-logo { font-size: 22px; font-weight: 800; color: var(--secondary); margin-bottom: 8px; }
        .credit { font-weight: 500; color: var(--text-light); font-size: 15px; margin-top: 20px; }
        .credit b { color: var(--secondary); font-weight: 700; }
        .credit span { color: var(--primary); }

        @media (max-width: 768px) {
            .hero h1 { font-size: 36px; }
            .tool-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <header>
        <div class="container">
            <nav>
                <a href="#" class="logo" onclick="location.reload()">
                    <div class="logo-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="white"><path d="M12 2L4.5 20.29L5.21 21L12 18L18.79 21L19.5 20.29L12 2Z"/></svg></div>
                    Image<span>Flow</span>
                </a>
                <div style="font-weight: 600; color: var(--text-light); font-size: 14px;">Privacy Protected</div>
            </nav>
        </div>
    </header>

    <main class="container">
        <!-- Dashboard -->
        <div id="dashboard">
            <section class="hero">
                <h1>The Ultimate <span>Flow</span> for Files</h1>
                <p>Professional grade tools for your images and documents. No server uploads, no fees, just pure browser-side power.</p>
            </section>

            <div class="tool-grid">
                <!-- 1. Images to PDF -->
                <div class="tool-card" onclick="openTool('img2pdf', 'Images to PDF', 'Combine multiple JPG/PNG images into a single PDF.')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#6366f1" stroke-width="1.5"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                    <h3>Images to PDF</h3>
                    <p>Combine photos to PDF</p>
                </div>
                <!-- 2. PDF to Image -->
                <div class="tool-card" onclick="openTool('pdf2img', 'PDF to Image', 'Convert PDF pages into high-quality JPG images.')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#6366f1" stroke-width="1.5"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><circle cx="12" cy="14" r="3"/></svg>
                    <h3>PDF to Image</h3>
                    <p>Extract pages to JPG</p>
                </div>
                <!-- 3. JPEG to PNG -->
                <div class="tool-card" onclick="openTool('jpg2png', 'JPEG to PNG', 'Convert JPEG photos to PNG with transparency support.')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#6366f1" stroke-width="1.5"><path d="M7 10V5M17 10V5M2 12h20M7 19v-5M17 19v-5M5 2h14a3 3 0 0 1 3 3v14a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3V5a3 3 0 0 1 3-3z"/></svg>
                    <h3>JPEG to PNG</h3>
                    <p>Change format to PNG</p>
                </div>
                <!-- 4. PNG to JPEG -->
                <div class="tool-card" onclick="openTool('png2jpg', 'PNG to JPEG', 'Convert PNG images to compact JPEG format.')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#6366f1" stroke-width="1.5"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><path d="m9 12 2 2 4-4"/></svg>
                    <h3>PNG to JPEG</h3>
                    <p>Change format to JPG</p>
                </div>
                <!-- 5. Image Size Reducer -->
                <div class="tool-card" onclick="openTool('compress', 'Image Size Reducer', 'Optimize and compress image file size instantly.')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#6366f1" stroke-width="1.5"><path d="M4 14V4h10l6 6v10H4"/><path d="M12 10V4M12 20v-6M9 17l3-3 3 3"/></svg>
                    <h3>Size Reducer</h3>
                    <p>Compress image KB/MB</p>
                </div>
                <!-- 6. HTML to ZIP -->
                <div class="tool-card" onclick="openTool('html2zip', 'HTML to ZIP', 'Upload .html files and bundle them into a ZIP folder.')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#6366f1" stroke-width="1.5"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/><path d="M12 11v6M9 14l3 3 3-3"/></svg>
                    <h3>HTML to ZIP</h3>
                    <p>Pack code into ZIP</p>
                </div>
                <!-- 7. Images to ZIP -->
                <div class="tool-card" onclick="openTool('img2zip', 'Images to ZIP', 'Bulk upload images and download them as a single ZIP.')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#6366f1" stroke-width="1.5"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><line x1="3" y1="9" x2="21" y2="9"/><line x1="9" y1="21" x2="9" y2="9"/></svg>
                    <h3>Images to ZIP</h3>
                    <p>Pack photos into ZIP</p>
                </div>
            </div>
        </div>

        <!-- Tool Interface -->
        <div id="tool-interface">
            <div class="back-link" onclick="location.reload()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>
                Back to Dashboard
            </div>
            
            <div style="text-align: center; margin-bottom: 40px;">
                <h2 id="tool-title" style="font-size: 36px; color: var(--secondary);">Tool Name</h2>
                <p id="tool-desc" style="color: var(--text-light);">Description.</p>
            </div>

            <div class="workspace" id="drop-zone" onclick="document.getElementById('file-input').click()">
                <svg width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="#cbd5e1" stroke-width="1.5"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"/></svg>
                <h2 style="margin-top: 20px;">Choose Files or Drag & Drop</h2>
                <p style="color: var(--text-light); margin-top: 5px;">Your files are processed locally in RAM</p>
                <input type="file" id="file-input" multiple>
                <button class="btn" style="margin-top: 30px;">Select Files</button>
            </div>

            <div id="processing-ui">
                <h2 id="status-msg">Processing...</h2>
                <div class="progress-container"><div class="progress-bar" id="bar"></div></div>
            </div>

            <div id="success-ui">
                <div class="success-icon">?</div>
                <h2 style="color: var(--secondary); margin-bottom: 8px;">Process Complete!</h2>
                <p style="color: var(--text-light); margin-bottom: 30px;">Your file is ready to download.</p>
                <a href="#" id="dl-btn" class="btn btn-success" download>Download Result</a>
                <br><br>
                <a href="#" onclick="location.reload()" style="color: var(--primary); font-weight: 700; text-decoration: none;">New Task</a>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="footer-logo">Image<span>Flow</span></div>
            <p style="font-size: 14px; color: var(--text-light);">Secure, Fast, Browser-Based file tools.</p>
            <div class="credit">Developed by <b>Khurram Naveed</b></div>
        </div>
    </footer>

    <script>
        const { jsPDF } = window.jspdf;
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js';

        let activeTool = '';
        let fileQueue = [];

        function openTool(id, name, desc) {
            activeTool = id;
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('tool-interface').style.display = 'block';
            document.getElementById('tool-title').innerText = name;
            document.getElementById('tool-desc').innerText = desc;
            window.scrollTo(0,0);
        }

        const fileInput = document.getElementById('file-input');
        const dropZone = document.getElementById('drop-zone');

        fileInput.addEventListener('change', (e) => handleUpload(e.target.files));
        dropZone.addEventListener('dragover', (e) => { e.preventDefault(); dropZone.classList.add('drag-over'); });
        dropZone.addEventListener('dragleave', () => dropZone.classList.remove('drag-over'));
        dropZone.addEventListener('drop', (e) => { e.preventDefault(); dropZone.classList.remove('drag-over'); handleUpload(e.dataTransfer.files); });

        function handleUpload(files) {
            fileQueue = Array.from(files);
            if(!fileQueue.length) return;
            
            document.getElementById('drop-zone').style.display = 'none';
            document.getElementById('processing-ui').style.display = 'block';
            
            let p = 0;
            let timer = setInterval(() => {
                p += Math.random() * 30;
                if(p >= 100) { p = 100; clearInterval(timer); runLogic(); }
                document.getElementById('bar').style.width = p + '%';
            }, 100);
        }

        async function runLogic() {
            try {
                if(activeTool === 'img2pdf') {
                    const doc = new jsPDF();
                    for(let i=0; i < fileQueue.length; i++) {
                        const data = await toBase64(fileQueue[i]);
                        if(i > 0) doc.addPage();
                        doc.addImage(data, 'JPEG', 10, 10, 190, 0);
                    }
                    finish(doc.output('blob'), "ImageFlow_Export.pdf");

                } else if(activeTool === 'pdf2img') {
                    const bytes = await fileQueue[0].arrayBuffer();
                    const pdf = await pdfjsLib.getDocument(bytes).promise;
                    const page = await pdf.getPage(1);
                    const viewport = page.getViewport({scale: 2});
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    canvas.height = viewport.height; canvas.width = viewport.width;
                    await page.render({canvasContext: ctx, viewport: viewport}).promise;
                    canvas.toBlob(b => finish(b, "ImageFlow_Extracted.jpg"), 'image/jpeg');

                } else if(activeTool === 'jpg2png' || activeTool === 'png2jpg') {
                    const data = await toBase64(fileQueue[0]);
                    const type = activeTool === 'jpg2png' ? 'image/png' : 'image/jpeg';
                    const blob = await canvasOp(data, 1.0, null, type);
                    finish(blob, `ImageFlow_Converted.${activeTool === 'jpg2png' ? 'png' : 'jpg'}`);

                } else if(activeTool === 'compress') {
                    const data = await toBase64(fileQueue[0]);
                    const blob = await canvasOp(data, 0.4); // 40% quality
                    finish(blob, "ImageFlow_Optimized.jpg");

                } else if(activeTool === 'html2zip' || activeTool === 'img2zip') {
                    const zip = new JSZip();
                    fileQueue.forEach(file => zip.file(file.name, file));
                    const content = await zip.generateAsync({type:"blob"});
                    finish(content, activeTool === 'html2zip' ? "HTML_Bundle.zip" : "Images_Bundle.zip");
                }
            } catch(e) {
                alert("Processing Error. Please check your file types.");
                location.reload();
            }
        }

        function toBase64(file) {
            return new Promise(res => {
                const r = new FileReader();
                r.onload = e => res(e.target.result);
                r.readAsDataURL(file);
            });
        }

        function canvasOp(src, qual, width, type = 'image/jpeg') {
            return new Promise(res => {
                const img = new Image();
                img.src = src;
                img.onload = () => {
                    const c = document.createElement('canvas');
                    const ctx = c.getContext('2d');
                    const w = width || img.width;
                    const h = (img.height / img.width) * w;
                    c.width = w; c.height = h;
                    if (type === 'image/jpeg') { ctx.fillStyle = "#fff"; ctx.fillRect(0,0,w,h); }
                    ctx.drawImage(img, 0, 0, w, h);
                    c.toBlob(blob => res(blob), type, qual);
                };
            });
        }

        function finish(blob, name) {
            const url = URL.createObjectURL(blob);
            const btn = document.getElementById('dl-btn');
            btn.href = url; btn.download = name;
            document.getElementById('processing-ui').style.display = 'none';
            document.getElementById('success-ui').style.display = 'block';
        }
    </script>
</body>
</html>